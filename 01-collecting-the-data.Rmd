# Collecting the Data

First things first, we need to acquire yearly datasets of crashes from the ARIES repository. They let you do so either by downloading csv files or by querying their API. I started with the API first, but ran into trouble when certain years wouldn't respond to my queries. I found that these same datasets would [return an error message](https://i.postimg.cc/wvxV7W9b/ARIES-server-not-responding.png) when trying to preview on the repository as well. Here we will take the approach of downloading all the datasets to disk as csv files before working with them.

Start by loading the needed R libraries.

```{r include=FALSE}
library(readr) # "The goal of 'readr' is to provide a fast and friendly way to read rectangular data (like 'csv', 'tsv', and 'fwf')."
library(dplyr) # "A fast, consistent tool for working with data frame like objects, both in memory and out of memory.
library(lubridate) # Lubridate makes it easier to do the things R does with date-times and possible to do the things R does not.
library(DBI) # A database interface definition for communication between R and relational database management systems.
```

Cool, let's get the yearly datasets downloaded to our computer.

```{r}
# Make a reference vector of years for the datasets
years <- 2007:2019

# Here is a vector of URL's for each year's repository of data
urls <- c(
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/994487c5-5d44-4fb9-ae9d-84ca75659bf0/download/aries_crash_data_2007.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/e4e56445-8cb6-4fc5-955c-7a2331684279/download/aries_crash_data_2008.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/881391be-d712-44b4-bfd0-ef9f018a4e4b/download/aries_crash_data_2009.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/46eb8985-f5b5-4635-9d6c-769dbd05fa02/download/aries_crash_data_2010.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/32ecfbfa-cf4b-4f64-af48-e1a624ae5ba4/download/aries_crash_data_2011.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/c2727405-925d-48fe-a8c1-06058ee65a25/download/aries_crash_data_2012.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/ca9adbd5-001e-49e7-a850-f9f3471eb2db/download/aries_crash_data_2013.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/a5262209-109c-49cd-b6a9-a72970dc1cf5/download/aries_crash_data_2014.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/7fd801c4-4cf3-4e18-a949-a4d21401d798/download/aries_crash_data_2015.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/88646815-5b52-433b-9609-c75500e48e4c/download/aries_crash_data_2016.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/911880b1-d0bb-4168-a5c1-a52dcc291445/download/aries_crash_data_2017.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/cc90589c-72d8-4d92-a5fe-73254b555c73/download/aries_crash_data_2018.csv",
    "https://hub.mph.in.gov/dataset/4ac55064-1f0d-4e5e-aeee-12faf28d6175/resource/7081439e-33c9-45f5-9c0b-86d8a8c49252/download/aries_crash_data_2019.csv"
)

# Make a new folder for the data files
system("mkdir raw-ARIES")

# Download the CSV files
for (i in 1:13) {
    download.file(url = urls[i], destfile = paste0("raw-ARIES/aries-crash-data-",years[i],".csv"))
}
```